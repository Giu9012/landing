<aside
  class="group flex flex-col rounded-lg p-6 w-max h-screen"
  [class.bg-white]="theme === 'light'"
  [class.bg-gray-900]="theme === 'dark'"
  (mouseleave)="closeUserMenu()"
>
  <ul class="flex flex-col gap-4 flex-1">
    <li
      class="grid grid-cols-[40px,0fr] items-center px-5 py-3 rounded transition-all duration-300 group-hover:grid-cols-[40px,1fr]"
    >
      <img [src]="logo.small" class="w-8" />
      <div class="overflow-hidden pl-5">
        <img [src]="logo.full" class="w-20" />
      </div>
    </li>

    @for (item of menuItems; track item.label) {
      <li class="cursor-pointer">
        <a
          [routerLink]="item.route"
          routerLinkActive="bg-[#007AFF] text-white"
          class="grid grid-cols-[40px,0fr] items-center px-7 py-3 rounded transition-all duration-300 group-hover:grid-cols-[40px,1fr]"
          [class.text-gray-600]="theme === 'light'"
          [class.text-gray-200]="theme === 'dark'"
          [class.hover:bg-[#007AFF]]="true"
          [class.hover:text-white]="true"
        >
          <i
            [class]="item.icon + ' text-lg'"
            [class.text-gray-600]="theme === 'light'"
            [class.text-gray-200]="theme === 'dark'"
          ></i>
          <div class="overflow-hidden pl-5">
            <p>{{ item.label }}</p>
          </div>
        </a>
      </li>
    }

    @if (user) {
      <li
        class="mt-auto relative grid grid-cols-[40px,0fr] items-center px-5 py-3 rounded transition-all duration-300 group-hover:grid-cols-[40px,1fr] cursor-pointer"
        [class.bg-gray-100]="theme === 'light' && userMenuOpen"
        [class.bg-gray-800]="theme === 'dark' && userMenuOpen"
        [class.hover:bg-gray-100]="theme === 'light'"
        [class.hover:bg-gray-800]="theme === 'dark'"
        (click)="toggleUserMenu()"
      >
        @if (user.avatar) {
          <img
            [src]="user.avatar"
            class="w-10 h-10 object-cover object-top rounded-full"
          />
        }
        <div class="overflow-hidden pl-5 text-nowrap text-left">
          <h3
            class="font-medium"
            [class.text-gray-600]="theme === 'light'"
            [class.text-gray-200]="theme === 'dark'"
          >{{ user.title || 'Sin t√≠tulo' }}</h3>
          <p
            class="text-sm"
            [class.text-gray-500]="theme === 'light'"
            [class.text-gray-400]="theme === 'dark'"
          >{{ user.info || 'Sin rol' }}</p>
        </div>

        <div
          class="absolute bottom-full left-0 mb-2 w-40 border rounded shadow-lg overflow-hidden transition-all duration-300 origin-bottom"
          [class.bg-white]="theme === 'light'"
          [class.bg-gray-800]="theme === 'dark'"
          [class.border-gray-200]="theme === 'light'"
          [class.border-gray-700]="theme === 'dark'"
          [class.opacity-100]="userMenuOpen"
          [class.opacity-0]="!userMenuOpen"
          [class.translate-y-0]="userMenuOpen"
          [class.translate-y-2]="!userMenuOpen"
          [class.pointer-events-none]="!userMenuOpen"
        >
          <ul>
            @for (opt of userMenu; track opt.label) {
              <li
                class="px-4 py-2 flex items-center gap-2 cursor-pointer transition-colors duration-200"
                [class.bg-gray-100]="theme === 'light' && userMenuOpen"
                [class.bg-gray-700]="theme === 'dark' && userMenuOpen"
                [class.hover:bg-gray-100]="theme === 'light'"
                [class.hover:bg-gray-700]="theme === 'dark'"
                [routerLink]="opt.route"
                (click)="closeUserMenu()"
              >
                <i
                  [class]="opt.icon + ' text-base'"
                  [class.text-gray-600]="theme === 'light'"
                  [class.text-gray-400]="theme === 'dark'"
                ></i>
                <span
                  [class.text-gray-600]="theme === 'light'"
                  [class.text-gray-200]="theme === 'dark'"
                >{{ opt.label }}</span>
              </li>
            }
          </ul>
        </div>
      </li>
    } @else {
      <li class="mt-auto text-center">Cargando perfil...</li>
    }
  </ul>
</aside>